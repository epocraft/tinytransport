# This file is the entry point to configure your own services.
# Files in the packages/ subdirectory configure your dependencies.

# Put parameters here that don't need to change on each machine where the app is deployed
# https://symfony.com/doc/current/best_practices.html#use-parameters-for-application-configuration
when@test:
    parameters:
        public_dir: '%kernel.project_dir%/public/'
        twig_base: 'http://localhost/SP_TinyTransport/web/public/'

when@dev:
    parameters:
        public_dir: '%kernel.project_dir%/public/'
        twig_base: 'http://localhost/SP_TinyTransport/web/public/'

when@prod:
    parameters:
        router.request_context.scheme: 'https'
        asset.request_context.secure: true
        public_dir: '%kernel.project_dir%/../public_html/www/'
        twig_base: 'https://www.sauneo.cz/'

parameters:
    timezone: '%env(APP_TIMEZONE)%'
    project_directory: '%public_dir%'
    app.supported_locales: 'cs|de|en'
    pusherPublicKey: '%env(PUSHER_KEY)%'
    pusherCluster: '%env(PUSHER_CLUSTER)%'
    admin:
        avatars_absolute_directory: '%public_dir%assets/admin/media/avatars/'
        avatars_relative_directory: 'assets/admin/media/avatars/'
        commands_absolute_directory: '%public_dir%assets/admin/media/commands/'
        commands_relative_directory: 'assets/admin/media/commands/'
        customers_absolute_directory: '%public_dir%assets/admin/media/customers/'
        customers_relative_directory: 'assets/admin/media/customers/'
        documents_absolute_directory: '%public_dir%assets/admin/media/documents/'
        documents_relative_directory: 'assets/admin/media/documents/'
        enquiries_absolute_directory: '%public_dir%assets/admin/media/enquiries/'
        enquiries_relative_directory: 'assets/admin/media/enquiries/'
        invoices_issued_absolute_directory: '%public_dir%assets/admin/media/invoices-issued/'
        invoices_issued_relative_directory: 'assets/admin/media/invoices-issued/'
        invoices_received_absolute_directory: '%public_dir%assets/admin/media/invoices-received/'
        invoices_received_relative_directory: 'assets/admin/media/invoices-received/'
        price_lists_absolute_directory: '%public_dir%assets/admin/media/price-lists/'
        price_lists_relative_directory: 'assets/admin/media/price-lists/'
        price_quotations_absolute_directory: '%public_dir%assets/admin/media/price-quotations/'
        price_quotations_relative_directory: 'assets/admin/media/price-quotations/'
        suppliers_absolute_directory: '%public_dir%assets/admin/media/suppliers/'
        suppliers_relative_directory: 'assets/admin/media/suppliers/'
    web:
        articles_absolute_directory: '%public_dir%assets/web/media/articles/'
        articles_relative_directory: 'assets/web/media/articles/'
        documents_absolute_directory: '%public_dir%assets/web/media/documents/'
        documents_relative_directory: 'assets/web/media/documents/'
        photogalleries_absolute_directory: '%public_dir%assets/web/media/photogalleries/'
        photogalleries_relative_directory: 'assets/web/media/photogalleries/'
        projects_absolute_directory: '%public_dir%assets/web/media/projects/'
        projects_relative_directory: 'assets/web/media/projects/'

services:
    # default configuration for services in *this* file
    _defaults:
        autowire: true      # Automatically injects dependencies in your services.
        autoconfigure: true # Automatically registers your services as commands, event subscribers, etc.

    # makes classes in src/ available to be used as services
    # this creates a service per class whose id is the fully-qualified class name
    App\:
        resource: '../src/'
        exclude:
            - '../src/DependencyInjection/'
            - '../src/Entity/'
            - '../src/Kernel.php'

    App\Controller\:
        resource: '../src/Controller/'
        tags: ['controller.service_arguments']

    # Listeners
    App\EventListener\Admin\LoginListener:
        tags:
            - { name: 'kernel.event_listener', event: 'security.interactive_login', method: 'onSecurityInteractiveLogin' }

    # Subscribers
    App\EventSubscriber\:
        resource: '../src/EventSubscriber/**/*'
        tags: ['kernel.event_subscriber']
        autowire: true
        autoconfigure: true

    #HTMLPurifier
    HTMLPurifier_Config:
        class: HTMLPurifier_Config
        factory: ['HTMLPurifier_Config', 'createDefault']
        calls:
            - method: set
              arguments:
                  - 'HTML.Allowed'
                  - 'p,strong,em,a[href]'
            # Další volání metod můžete přidat zde, např.:
            #- method: set
            #  arguments:
            #      - 'CSS.AllowedProperties'
            #      - ''  # povolí žádné CSS vlastnosti

    HTMLPurifier:
        class: HTMLPurifier
        arguments:
            - '@HTMLPurifier_Config'

    # Liip
    Liip\ImagineBundle\Binary\Loader\LoaderInterface: '@liip_imagine.binary.loader.default'

    # TWIG
    App\Twig\FlashMessagesExtension:
        tags: ['twig.extension']
    App\Twig\FileExistsExtension:
        tags: ['twig.extension']
    App\Twig\IsProjectModuleEnabledExtension:
        tags: ['twig.extension']
    App\Twig\LcFirstExtension:
        tags: ['twig.extension']
    App\Twig\TranslationKeyExistsExtension:
        tags: ['twig.extension']
    Twig\Extension\StringLoaderExtension:
        tags:
            - { name: twig.extension }
    App\Twig\UserContextExtension:
        tags: ['twig.extension']

    # add more service definitions when explicit configuration is needed
    # please note that last definitions always *replace* previous ones